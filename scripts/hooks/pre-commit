cd "$(git rev-parse --show-toplevel)"
if git diff --staged --quiet --exit-code HEAD nvim-ghost-text.py
then :
else
	echo "nvim-ghost-text.py has been changed"
	if [ $(git diff --staged HEAD nvim-ghost-text.py | grep -c '^.BUILD_VERSION') -ne 2 ]
	then
		echo "Please update BUILD_VERSION"
		exit 1
	fi
fi

if [ "$(cat .binary_version)" != "$(python nvim-ghost-text.py --version)" ]
then
	echo "BUILD_VERSION of nvim-ghost-text.py does not match with .build_version"
	exit 1
fi
